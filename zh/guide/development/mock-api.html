<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mock Data | MapGIS Pan-Spatial Map</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/mapgis-pan-spatial-map-docs/favicon.ico">
    <meta name="description" content="全行业一张图应用平台">
    <meta name="keywords" content="mapgis,开源,免费,全空间,一张图">
    <link rel="preload" href="/mapgis-pan-spatial-map-docs/assets/css/0.styles.7c88bc84.css" as="style"><link rel="preload" href="/mapgis-pan-spatial-map-docs/assets/js/app.cfd4b1ef.js" as="script"><link rel="preload" href="/mapgis-pan-spatial-map-docs/assets/js/2.82004f15.js" as="script"><link rel="preload" href="/mapgis-pan-spatial-map-docs/assets/js/12.b643204b.js" as="script"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/10.6e49afeb.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/11.e0325fba.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/13.a22a87d3.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/14.350e2e14.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/15.52732794.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/3.c15b449a.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/4.7d5f245c.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/5.dc439d27.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/6.f7d36eba.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/7.ae91fdcd.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/8.e0592a13.js"><link rel="prefetch" href="/mapgis-pan-spatial-map-docs/assets/js/9.e9a9ae29.js">
    <link rel="stylesheet" href="/mapgis-pan-spatial-map-docs/assets/css/0.styles.7c88bc84.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mapgis-pan-spatial-map-docs/zh/" class="home-link router-link-active"><!----> <span class="site-name">MapGIS Pan-Spatial Map</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mapgis-pan-spatial-map-docs/zh/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mapgis-pan-spatial-map-docs/" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/mapgis-pan-spatial-map-docs/zh/guide/development/mock-api.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/mapgis/mapgis-pan-spatial-map" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mapgis-pan-spatial-map-docs/zh/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mapgis-pan-spatial-map-docs/" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/mapgis-pan-spatial-map-docs/zh/guide/development/mock-api.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/mapgis/mapgis-pan-spatial-map" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>入门</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>开发</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mapgis-pan-spatial-map-docs/zh/guide/development/mock-api.html" aria-current="page" class="active sidebar-link">Mock Data</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mapgis-pan-spatial-map-docs/zh/guide/development/mock-api.html#swagger" class="sidebar-link">Swagger</a></li><li class="sidebar-sub-header"><a href="/mapgis-pan-spatial-map-docs/zh/guide/development/mock-api.html#mockjs" class="sidebar-link">Mockjs</a></li><li class="sidebar-sub-header"><a href="/mapgis-pan-spatial-map-docs/zh/guide/development/mock-api.html#目前方案" class="sidebar-link">目前方案</a></li><li class="sidebar-sub-header"><a href="/mapgis-pan-spatial-map-docs/zh/guide/development/mock-api.html#移除" class="sidebar-link">移除</a></li><li class="sidebar-sub-header"><a href="/mapgis-pan-spatial-map-docs/zh/guide/development/mock-api.html#新增" class="sidebar-link">新增</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>构建和部署</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其它</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mock-data"><a href="#mock-data" class="header-anchor">#</a> Mock Data</h1> <p>Mock 数据是前端开发过程中必不可少的一环，是分离前后端开发的关键链路。通过预先跟服务器端约定好的接口，模拟请求数据甚至逻辑，能够让前端开发更加独立自主，不会被服务端的开发所阻塞。</p> <h2 id="swagger"><a href="#swagger" class="header-anchor">#</a> Swagger</h2> <p>在公司的项目中通常使用 <a href="https://swagger.io/" target="_blank" rel="noopener noreferrer">swagger<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>， 由后端来模拟业务数据。
<strong>swagger</strong> 是一个 REST APIs 文档生成工具，它从代码注释中自动生成文档，可以跨平台，开源，支持大部分语言，社区好，总之非常不错，强烈推荐。
<a href="http://petstore.swagger.io/?_ga=2.222649619.983598878.1509960455-2044209180.1509960455#/pet/addPet" target="_blank" rel="noopener noreferrer">线上 demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="mockjs"><a href="#mockjs" class="header-anchor">#</a> Mockjs</h2> <p><a href="https://github.com/nuysoft/Mock" target="_blank" rel="noopener noreferrer">mockjs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的原理是: 拦截了所有的请求并代理到本地，然后进行数据模拟，所以你会发现 <code>network</code> 中没有发出任何的请求。</p> <p>但它的最大的问题是就是它的实现机制。它会重写浏览器的<code>XMLHttpRequest</code>对象，从而才能拦截所有请求，代理到本地。大部分情况下用起来还是蛮方便的，但就因为它重写了<code>XMLHttpRequest</code>对象，所以比如<code>progress</code>方法，或者一些底层依赖<code>XMLHttpRequest</code>的库都会和它发生不兼容。</p> <p>它还有一个问题是，因为是它本地模拟的数据，实际上不会走任何网络请求。所以本地调试起来很蛋疼，只能通过<code>console.log</code>来调试。</p> <h2 id="目前方案"><a href="#目前方案" class="header-anchor">#</a> 目前方案</h2> <p>在本地会启动一个<code>mock-server</code>来模拟数据，该方案的好处是，在保留 <code>mockjs</code>的优势的同时，解决之前的痛点。由于我们的 mock 是完全基于<code>webpack-dev-serve</code>来实现的，所以在你启动前端服务的同时，<code>mock-server</code>就会自动启动，而且这里还通过 <a href="https://github.com/paulmillr/chokidar" target="_blank" rel="noopener noreferrer">chokidar<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来观察 <code>mock</code> 文件夹内容的变化。在发生变化时会清除之前注册的<code>mock-api</code>接口，重新动态挂载新的接口，从而支持热更新。有兴趣的可以自己看一下代码<a href="https://github.com/MapGIS/MapGIS-Pan-Spatial-Map/blob/master/packages/pan-spatial-map-mock-server/mock/mock-server.ts" target="_blank" rel="noopener noreferrer">mock-server.ts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。由于是一个真正的<code>server</code>，所以你可以通过控制台中的<code>network</code>，清楚的知道接口返回的数据结构。并且同时解决了之前<code>mockjs</code>会重写 <code>XMLHttpRequest</code>对象，导致很多第三方库失效的问题。</p> <h2 id="移除"><a href="#移除" class="header-anchor">#</a> 移除</h2> <p>如果你不想使用<code>mock-server</code>的话只要在<a href="https://github.com/MapGIS/MapGIS-Pan-Spatial-Map/blob/master/packages/pan-spatial-map-plugin-auth/src/templates/src/statics/plugins/auth/config.json" target="_blank" rel="noopener noreferrer">config.json<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>中修改<code>&quot;^/onemap&quot;</code>指向实际的全空间一张图服务器地址就可以了。</p> <h2 id="新增"><a href="#新增" class="header-anchor">#</a> 新增</h2> <p>如果你想添加 mock 数据，只要在<code>packages/pan-spatial-map-mock-server</code>根目录下找到<code>mock</code>文件，添加对应的路由，对其进行拦截和模拟数据即可。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/mapgis/mapgis-pan-spatial-map-docs/edit/master/docs/zh/guide/development/mock-api.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2020-7-27 17:28:36</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/mapgis-pan-spatial-map-docs/zh/guide/introduction/available-script.html" class="prev">
        可用的脚本
      </a></span> <span class="next"><a href="/mapgis-pan-spatial-map-docs/zh/guide/build-deployment/build.html">
        构建
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/mapgis-pan-spatial-map-docs/assets/js/app.cfd4b1ef.js" defer></script><script src="/mapgis-pan-spatial-map-docs/assets/js/2.82004f15.js" defer></script><script src="/mapgis-pan-spatial-map-docs/assets/js/12.b643204b.js" defer></script>
  </body>
</html>
